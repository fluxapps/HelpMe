il.HelpMe={IDS:["ilMMSearch","userlog","mm_lang_sel"],MODAL_TEMPLATE:"",SUPPORT_BUTTON_TEMPLATE:"",autoOpen:!1,button:null,li:null,modal:null,requestAgain:!0,screenshots:null,cancel:function(){return this.modal.modal("hide"),!1},click:function(){var a=this.button.attr("href");return $.get(a,this.show.bind(this)),!1},hide:function(){this.modal.find(".modal-body").html(""),null!==this.screenshots&&(il.ScreenshotsInputGUI.removeInstance(this.screenshots),this.screenshots=null)},init:function(){$(document).ready(function(){this.initButton(),this.initModal(),this.autoOpen&&this.click()}.bind(this))},initButton:function(){this.li=$(this.SUPPORT_BUTTON_TEMPLATE),this.button=this.li.children(0),this.button.click(this.click.bind(this));var a=this.IDS.every(function(a){var b=document.getElementById(a);return!(null!==b)||("li"!==b.tagName.toLowerCase()&&(b=b.parentElement),$(b).before(this.li),!1)},this);a&&$("#ilTopBarNav").append(this.li)},initModal:function(){this.modal=$(this.MODAL_TEMPLATE),$("body").append(this.modal),this.modal.on("hide.bs.modal",this.hide.bind(this))},show:function(a){if(-1===a.indexOf("form_helpme_form")&&this.requestAgain)return this.requestAgain=!1,void this.click();this.requestAgain=!1,this.modal.find(".modal-body").html(a);var b=[];null!==this.screenshots&&(b=this.screenshots.screenshots),this.screenshots=il.ScreenshotsInputGUI.lastInstance(),this.screenshots===void 0?this.screenshots=null:(this.screenshots.screenshots=b,this.screenshots.modal=this.modal,this.screenshots.updateScreenshots());var c=$("#form_helpme_form"),d=$("#helpme_cancel");c.submit(this.submit.bind(this)),d.click(this.cancel.bind(this)),this.modal.modal("show")},submit:function(){var a=$("#form_helpme_form"),b=$("#helpme_submit"),c=a.attr("action"),d=new FormData(a[0]);return d.append(b.prop("name"),b.val()),this.screenshots.addScreenshotsToUpload(d),$.ajax({type:"post",url:c,contentType:!1,processData:!1,data:d,success:this.show.bind(this)}),!1}};